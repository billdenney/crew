<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Centralized Reusable Workers • crew</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Centralized Reusable Workers">
<meta property="og:description" content="The R6 classes of crew establish a standardized
  user interface to high-performance computing technologies.
  Unlike the closely related future package
  (2021, &lt;doi:10.32614/RJ-2021-048&gt;), crew prioritizes centralized
  scheduling, heterogeneous semi-persistent workers,
  and user-driven customization. The purpose is to enable pipeline
  tools such as such targets (2021, &lt;doi:10.21105/joss.02959&gt;)
  to efficiently orchestrate tasks without having to support
  individual low-level interfaces to specific high-performance
  computing platforms or cloud services.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">crew</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
<li>
  <a href="articles/specification.html">Specification</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/targets" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="crew">crew<a class="anchor" aria-label="anchor" href="#crew"></a>
</h1></div>
<!--[![CRAN](https://www.r-pkg.org/badges/version/crew)](https://CRAN.R-project.org/package=crew)-->

<p>The <a href="https://r6.r-lib.org" class="external-link"><code>R6</code></a> classes of <code>crew</code> establish a standardized user interface to high-performance computing technologies. Unlike its closely related <a href="https://future.futureverse.org/" class="external-link"><code>future</code></a> package, <code>crew</code> prioritizes centralized scheduling, heterogeneous semi-persistent workers, and user-driven customization. The primary goal is to help pipeline tools such as such <a href="https://docs.ropensci.org/targets/" class="external-link"><code>targets</code></a> efficiently orchestrate tasks without having to support individual low-level interfaces to specific high-performance computing platforms or cloud services.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"wlandau/crew"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>First, create a <code>crew</code> object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wlandau.github.io/crew/" class="external-link">crew</a></span><span class="op">)</span>
<span class="va">crew</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/class_crew.html">class_crew</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Optionally, supply the store and worker classes you plan to use. The store determines where the input and output data live for jobs (local file system, Amazon S3 bucket, Google Cloud bucket, etc.), and worker classes control where and how the workers run (locally in a different R session, Amazon Web Services, Google Cloud Platform, etc.).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crew</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/class_crew.html">class_crew</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  store <span class="op">=</span> <span class="va"><a href="reference/class_store_local.html">class_store_local</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,
  worker_classes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    <span class="va">class_worker_callr</span>,
    <span class="va">class_worker_future</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>If you use <code>class_worker_future</code>, choose a plan.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.callr.futureverse.org" class="external-link">future.callr</a></span><span class="op">)</span>
<span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">callr</span><span class="op">)</span></code></pre></div>
<p>Create worker objects with the <code>recruit()</code> method.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crew</span><span class="op">$</span><span class="fu">recruit</span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># callr workers</span></code></pre></div>
<p>Optionally, create worker objects of a specified class and set fields like timeout and tags.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">crew</span><span class="op">$</span><span class="va">worker_classes</span><span class="op">)</span>
<span class="co">#&gt; [1] "worker_callr"  "worker_future"</span>
<span class="va">crew</span><span class="op">$</span><span class="fu">recruit</span><span class="op">(</span>
  workers <span class="op">=</span> <span class="fl">2</span>,
  class <span class="op">=</span> <span class="st">"worker_future"</span>,
  tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"long_jobs_go_here"</span>, <span class="st">"my_future_workers"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>No workers are running yet.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl</a></span><span class="op">(</span><span class="va">crew</span><span class="op">$</span><span class="va">workers</span>, <span class="op">~</span><span class="va">.x</span><span class="op">$</span><span class="fu">up</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; worker_e42926df1465 worker_e4297fb406d2 worker_e429665e3c55 worker_e42934cb24f4 </span>
<span class="co">#&gt;               FALSE               FALSE               FALSE               FALSE</span></code></pre></div>
<p>To start any or all workers, either use <code>launch()</code> or <code>send()</code>. The latter finds a suitable available worker, launches it if necessary, and then sends a job. Poll with <code>receivable()</code> and get the output with <code>receive()</code>. Tags let you control which kinds of workers get the jobs, and they are are supported and optional in all relevant crew methods.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">job</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">seconds</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="va">seconds</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"This is a warning."</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Job ran in %s seconds."</span>, <span class="va">seconds</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># The job runs on a worker of class "worker_future" in this case</span>
<span class="co"># because those two workers are tagged with "long_jobs_go_here".</span>
<span class="va">crew</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">job</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>seconds <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, tags <span class="op">=</span> <span class="st">"long_jobs_go_here"</span><span class="op">)</span>

<span class="co"># Do other tasks while the job runs in the background.</span>
<span class="va">do_other_tasks</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span><span class="op">)</span>
  <span class="kw">while</span> <span class="op">(</span><span class="op">!</span><span class="va">crew</span><span class="op">$</span><span class="fu">receivable</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>

<span class="fu">do_other_tasks</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.003</span>
<span class="co">#&gt; [1] 2.012</span>
<span class="co">#&gt; [1] 3.013</span>
<span class="co">#&gt; [1] 4.015</span>
<span class="co">#&gt; [1] 5.016</span>

<span class="co"># Get the output when ready.</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="va">crew</span><span class="op">$</span><span class="fu">receive</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The output contains the result of the job, as well as warnings, errors, etc.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span>
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ value    : chr "Job ran in 4 seconds."</span>
<span class="co">#&gt;  $ seconds  : num 4</span>
<span class="co">#&gt;  $ error    : NULL</span>
<span class="co">#&gt;  $ traceback: NULL</span>
<span class="co">#&gt;  $ warnings : chr "This is a warning."</span></code></pre></div>
<p>Once launched, workers stay running until they time out or shut down.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">is_up</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl</a></span><span class="op">(</span><span class="va">crew</span><span class="op">$</span><span class="va">workers</span>, <span class="op">~</span><span class="va">.x</span><span class="op">$</span><span class="fu">up</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">is_up</span>
<span class="co">#&gt; worker_e42926df1465 worker_e4297fb406d2 worker_e429665e3c55 worker_e42934cb24f4 </span>
<span class="co">#&gt;               FALSE               FALSE                TRUE               FALSE</span></code></pre></div>
<p>Sure enough, the running worker has the tags of the previous job.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">is_up</span><span class="op">[</span><span class="va">is_up</span><span class="op">]</span><span class="op">)</span>
<span class="va">crew</span><span class="op">$</span><span class="va">workers</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">tags</span>
<span class="co">#&gt; [1] "long_jobs_go_here" "my_future_workers"</span></code></pre></div>
<p><code>crew</code> tries to send jobs to workers that are already running. If all running workers are busy, new ones will launch automatically. Use <code>sendable()</code> to check if any workers can accept new work.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crew</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">job</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>seconds <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, tags <span class="op">=</span> <span class="st">"long_jobs_go_here"</span><span class="op">)</span>
<span class="va">crew</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">job</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>seconds <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># May run on any available worker.</span>

<span class="fu">do_other_tasks</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.005</span>
<span class="co">#&gt; [1] 2.007</span>
<span class="co">#&gt; [1] 3.008</span>
<span class="co">#&gt; [1] 4.009</span>
<span class="co">#&gt; [1] 5.013</span>

<span class="va">output_first</span> <span class="op">&lt;-</span> <span class="va">crew</span><span class="op">$</span><span class="fu">receive</span><span class="op">(</span><span class="op">)</span>

<span class="fu">do_other_tasks</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.001</span>
<span class="co">#&gt; [1] 2.004</span>
<span class="co">#&gt; [1] 3.004</span>
<span class="co">#&gt; [1] 4.01</span>

<span class="va">output_second</span> <span class="op">&lt;-</span> <span class="va">crew</span><span class="op">$</span><span class="fu">receive</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">output_first</span><span class="op">)</span>
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ value    : chr "Job ran in 4 seconds."</span>
<span class="co">#&gt;  $ seconds  : num 4</span>
<span class="co">#&gt;  $ error    : NULL</span>
<span class="co">#&gt;  $ traceback: NULL</span>
<span class="co">#&gt;  $ warnings : chr "This is a warning."</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">output_second</span><span class="op">)</span>
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ value    : chr "Job ran in 8 seconds."</span>
<span class="co">#&gt;  $ seconds  : num 8.02</span>
<span class="co">#&gt;  $ error    : NULL</span>
<span class="co">#&gt;  $ traceback: NULL</span>
<span class="co">#&gt;  $ warnings : chr "This is a warning."</span></code></pre></div>
<p>To shut down one or more workers, use <code>shutdown()</code>. By default, only idle workers are shut down.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crew</span><span class="op">$</span><span class="fu">shutdown</span><span class="op">(</span><span class="op">)</span>
<span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_lgl</a></span><span class="op">(</span><span class="va">crew</span><span class="op">$</span><span class="va">workers</span>, <span class="op">~</span><span class="va">.x</span><span class="op">$</span><span class="fu">up</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>To delete one or more worker objects from the crew, use <code>dismiss()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">crew</span><span class="op">$</span><span class="fu">dismiss</span><span class="op">(</span>tags <span class="op">=</span> <span class="st">"long_jobs_go_here"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">crew</span><span class="op">$</span><span class="va">workers</span><span class="op">)</span> <span class="co"># Should be 2.</span>
<span class="co">#&gt; [1] 2</span></code></pre></div>
<p>If eventually a worker gets stuck (not sendable, not receivable, not running) then the <code>stuck()</code> method of the worker will return <code>TRUE</code> and the <code><a href="https://rdrr.io/r/base/base-defunct.html" class="external-link">restart()</a></code> method will restart it. Use the <code><a href="https://rdrr.io/r/base/base-defunct.html" class="external-link">restart()</a></code> method of the crew object to restart one or more stuck workers.</p>
</div>
<div class="section level2">
<h2 id="nested-crews">Nested crews<a class="anchor" aria-label="anchor" href="#nested-crews"></a>
</h2>
<p>Large data science pipelines manage hundreds of distributed workers on different machines, from traditional clusters to cloud platforms by Amazon and Google. In these situations, orchestration itself is computationally demanding. Sending jobs, receiving job output, and detecting crashes may severely block the main process.</p>
<p>To overcome this bottleneck, <code>crew</code> package will eventually support nested crews. The outer crew will support a small number of <code><a href="https://callr.r-lib.org/reference/r_bg.html" class="external-link">callr::r_bg()</a></code> workers running on the same machine as the main process. Each of these outer workers will run a crew of its own, and the inner crews will run hundreds of inner workers on distributed systems like AWS Batch. The outer workers will run a different event loop that forwards jobs from the outer crew to the inner crews and back.</p>
</div>
<div class="section level2">
<h2 id="new-backends">New backends<a class="anchor" aria-label="anchor" href="#new-backends"></a>
</h2>
<p>The <code>crew</code> package is arbitrarily extensible. It is designed to support multiple backend services (e.g. Amazon, Google, Azure) with minimal changes to the <code>R6</code> interface. For Amazon S3 storage for jobs, one can write a new subclass of <code>class_store</code> and write methods analogous to those of <code>class_store_local</code>. Likewise, for Amazon AWS Batch or Google Cloud Run workers, one can write new worker subclasses analogous to <code>class_worker_callr</code> and <code>class_worker_future</code>. All these classes are documented in help files, and a specification of required methods and fields is in the <a href="https://wlandau.github.io/crew/articles/specification.html" class="external-link">specification vignette</a>. The new subclasses will be supported in separate R packages that import <code>crew</code>, ideally one package per cloud platform.</p>
</div>
<div class="section level2">
<h2 id="thanks">Thanks<a class="anchor" aria-label="anchor" href="#thanks"></a>
</h2>
<p>The <code>crew</code> package incorporates insightful ideas from the following people.</p>
<ul>
<li>
<a href="https://github.com/krlmlr/" class="external-link">Kirill Müller</a>. The <a href="https://github.com/wlandau/worker" class="external-link"><code>workers</code></a> prototype was entirely his vision, and <code>crew</code> would not exist without it. <code>crew</code> reflects this and many other insights from Kirill about orchestration models for R processes.</li>
<li>
<a href="https://github.com/HenrikBengtsson/" class="external-link">Henrik Bengtsson</a>. Henrik’s <a href="https://github.com/HenrikBengtsson/future/" class="external-link"><code>future</code></a> package ecosystem demonstrates the incredible power of a consistent R interface on top of a varying collection of high-performance computing technologies.</li>
<li>
<a href="https://github.com/mschubert/" class="external-link">Michael Schubert</a>. Michael’s <a href="https://mschubert.github.io/clustermq/" class="external-link"><code>clustermq</code></a> package supports efficient high-performance computing on traditional clusters, and it demonstrates the value of a central <code>R6</code> object to manage an entire collection of persistent workers.</li>
<li>
<a href="https://github.com/davidkretch" class="external-link">David Kretch</a>. The <a href="https://github.com/paws-r/paws" class="external-link"><code>paws</code></a> R package is a powerful interface to Amazon Web Services, and the documentation clearly communicates the capabilities and limitations of AWS to R users.</li>
<li>
<a href="https://github.com/adambanker" class="external-link">Adam Banker</a>, co-authored <a href="https://github.com/paws-r/paws" class="external-link"><code>paws</code></a> with <a href="https://github.com/davidkretch" class="external-link">David Kretch</a>.</li>
<li>
<a href="https://github.com/mdneuzerling" class="external-link">David Neuzerling</a>. David’s <a href="https://github.com/mdneuzerling/lambdr/" class="external-link"><code>lambdr</code></a> package establishes a helpful pattern to submit and collect AWS Lambda jobs from R.</li>
<li>
<a href="https://github.com/MarkEdmondson1234/" class="external-link">Mark Edmondson</a>. Mark maintains several R packages to interface with Google Cloud Platform such as <a href="https://github.com/cloudyr/googleCloudStorageR" class="external-link"><code>googleCloudStorageR</code></a> and <a href="https://github.com/MarkEdmondson1234/googleCloudRunner" class="external-link"><code>googleCloudRunner</code></a>, and he <a href="https://github.com/ropensci/targets/issues/720" class="external-link">started the conversation</a> around helping <a href="https://github.com/ropensci/targets" class="external-link"><code>targets</code></a> submit jobs to Google Cloud Run.</li>
</ul>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <code>crew</code> project is released with a <a href="https://github.com/wlandau/crew/blob/main/CODE_OF_CONDUCT.md" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"crew"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To cite package 'crew' in publications use:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   William Michael Landau (NA). crew: Centralized Reusable Workers.</span>
<span class="co">#&gt;   https://wlandau.github.io/crew/, https://github.com/wlandau/crew.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A BibTeX entry for LaTeX users is</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   @Manual{,</span>
<span class="co">#&gt;     title = {crew: Centralized Reusable Workers},</span>
<span class="co">#&gt;     author = {William Michael Landau},</span>
<span class="co">#&gt;     note = {https://wlandau.github.io/crew/, https://github.com/wlandau/crew},</span>
<span class="co">#&gt;   }</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/wlandau/crew/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/wlandau/crew/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing crew</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>William Michael Landau <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1878-3253" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#wip" class="external-link"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="status"></a></li>
<li><a href="https://github.com/wlandau/crew/actions?query=workflow%3Acheck" class="external-link"><img src="https://github.com/wlandau/crew/workflows/check/badge.svg" alt="check"></a></li>
<li><a href="https://app.codecov.io/gh/wlandau/crew" class="external-link"><img src="https://codecov.io/gh/wlandau/crew/branch/main/graph/badge.svg?token=3T5DlLwUVl" alt="codecov"></a></li>
<li><a href="https://github.com/wlandau/crew/actions?query=workflow%3Alint" class="external-link"><img src="https://github.com/wlandau/crew/workflows/lint/badge.svg" alt="lint"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by William Michael Landau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
